I"	<h2 id="신규-connection-증가-원인과-대응-방법">신규 connection 증가 원인과 대응 방법</h2>

<ul>
  <li>connection이 자주 맺고 끊어지면 DB단에 부하를 주기 때문에 개선해야합니다.</li>
</ul>

<p><img src="https://oss.navercorp.com/OracleDBA/developer_FAQ/blob/master/assets/images/connection_user.jpg?raw=true" alt="connection_user" /></p>

<p><strong>조치 방법</strong></p>
<ul>
  <li>oracle DB에 접근하는 사용자가 증가하는 경우
    <blockquote>
      <ul>
        <li>connection max에 도달하려고 한다면 DBA와 협의하여 DB process 수 증가 필요합니다.</li>
        <li>증설된 WAS로 인해 문제가 될 수 있으므로 tomcat 등의 수를 조절합니다.</li>
        <li>구 장비에서 신규 장비로 변경하는 작업이 진행중이라면 신규 장비를 한 번에 추가하지 말고 나눠서 추가합니다.</li>
      </ul>
    </blockquote>
  </li>
  <li>한 세션에서 table lock을 잡고 작업을 오랜 시간동안 진행하는 경우
    <blockquote>
      <ul>
        <li>쿼리 문제인지 살펴봐야 하기 때문에 DBA와 협의가 필요합니다.</li>
        <li>쿼리 상 문제가 없는 경우 이용이 많은 테이블을 분산할 수 있는 방법을 고려합니다.(파티셔닝 등)</li>
      </ul>
    </blockquote>
  </li>
  <li>pooling은 했으나 dbcp 설정을 너무 크게 해놔서 inactive인 session이 증가하는 경우
    <blockquote>
      <ul>
        <li>dbcp 설정 값을 너무 크게 해놔서 배치 작업 등으로 인해 connection 수 증가 후 inactive 세션들이 계속 유지됩니다.</li>
        <li>위와 같은 경우 dbcp 설정 값을 조정해서 connection 수를 줄입니다.</li>
      </ul>
    </blockquote>
  </li>
  <li>connection pooling을 해놓지 않아서 접근할 때마다 신규 커넥션을 맺어야하는 경우
    <blockquote>
      <ul>
        <li>DB 서버로 접근하는 트래픽을 살펴보고 connection pooling을 합니다.</li>
        <li>connection을 맺은 후 커넥션을 유지되어 재사용이 가능하기 때문에 신규 커넥션 발생을 줄일 수 있습니다.</li>
      </ul>

    </blockquote>
  </li>
  <li>개발 code logic 상 connection close를 안한 경우
    <blockquote>
      <ul>
        <li>해당 부분을 찾아 logic 수정이 필요합니다.</li>
      </ul>
    </blockquote>
  </li>
</ul>
:ET